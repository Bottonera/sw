async function a(t,i){const r={tag:i.id},n=await t.registration.getNotifications(r);for(const o of n)o.data.tracked=!0,o.close();const c={};c.tag=i.id,c.renotify=!0,i.trackClickedUrl&&i.confirmText&&!i.isConfirmed&&(c.requireInteraction=!0,c.actions||(c.actions=[]),c.actions.push({action:"confirm",title:i.confirmText})),i.body&&(c.body=i.body),i.imageSmall&&(c.icon=i.imageSmall),i.imageLarge&&(c.image=i.imageLarge),c.data=i,await t.registration.showNotification(i.subject,c),i.trackDeliveredUrl&&fetch(i.trackDeliveredUrl)}(function(t){console.log("SW Loaded"),t.addEventListener("notificationclick",i=>{const r=i.notification.data;if(r.trackSeenUrl&&!i.notification.data.tracked){i.notification.data.tracked=!0;const n=fetch(r.trackSeenUrl);i.waitUntil(n)}if(r.trackClickedUrl){const n=fetch(r.trackClickedUrl);i.waitUntil(n)}if(i.action==="confirm"){if(r.confirmLink&&t.clients.openWindow){const n=t.clients.openWindow(r.confirmLink);i.waitUntil(n)}}else if(r.linkUrl&&t.clients.openWindow){const n=t.clients.openWindow(r.linkUrl);i.notification.close(),i.waitUntil(n)}}),t.addEventListener("notificationclose",i=>{const r=i.notification.data;if(r.trackSeenUrl&&!i.notification.data.manualClose){const n=fetch(r.trackSeenUrl);i.waitUntil(n)}}),t.addEventListener("install",()=>{t.skipWaiting()}),t.addEventListener("push",i=>{if(i.data){const r=e(i.data.json()),n=a(t,r);i.waitUntil(n)}})})(self);const e=t=>({id:t.id,subject:t.subject,trackingToken:t.trackingToken,body:t.body,imageSmall:t.imageSmall,imageLarge:t.imageLarge,linkUrl:t.linkUrl,linkText:t.linkText,trackClickedUrl:t.confirmUrl,confirmLink:t.confirmLink,confirmText:t.confirmText,trackDeliveredUrl:t.trackDeliveredUrl,trackSeenUrl:t.trackSeenUrl,created:t.created,updated:t.updated});
